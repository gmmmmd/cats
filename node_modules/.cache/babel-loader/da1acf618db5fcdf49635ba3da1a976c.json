{"ast":null,"code":"import _regeneratorRuntime from\"/home/user/work2/cats/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _toConsumableArray from\"/home/user/work2/cats/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _asyncToGenerator from\"/home/user/work2/cats/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/user/work2/cats/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from'react';import{Routes,Route}from'react-router-dom';import Layout from'./component/Layout/Layout';import Homepage from'./pages/HomePage/Homepage';import Favoritpage from'./pages/Favoritpage/Favoritpage';import Notfoundpage from'./pages/Notfoundpage/Notfoundpage';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function App(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),cats=_useState2[0],setCats=_useState2[1];var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),isLoading=_useState4[0],setIsLoading=_useState4[1];var _useState5=useState(1),_useState6=_slicedToArray(_useState5,2),currentPage=_useState6[0],setCurrentPage=_useState6[1];var _useState7=useState(true),_useState8=_slicedToArray(_useState7,2),fetching=_useState8[0],setFetching=_useState8[1];var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),favorites=_useState10[0],setFavorites=_useState10[1];var _useState11=useState([false]),_useState12=_slicedToArray(_useState11,2),checked=_useState12[0],setChecked=_useState12[1];// Запрос котиков\nuseEffect(function(){if(fetching){var fetchData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response,result;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return fetch(\"https://api.thecatapi.com/v1/images/search?limit=20&page=\".concat(currentPage),{headers:{'Content-Type':'app;ication/json','x-api-key':'e903b6b3-eaca-44ce-829a-f91cff82b3d2'}});case 3:response=_context.sent;if(!(response.status===200)){_context.next=11;break;}_context.next=7;return response.json();case 7:result=_context.sent;setCats([].concat(_toConsumableArray(cats),_toConsumableArray(result)));setCurrentPage(function(prevState){return prevState+1;});console.log(result);case 11:_context.next=16;break;case 13:_context.prev=13;_context.t0=_context[\"catch\"](0);console.log(_context.t0);case 16:_context.prev=16;setIsLoading(false);setFetching(false);return _context.finish(16);case 20:case\"end\":return _context.stop();}}},_callee,null,[[0,13,16,20]]);}));return function fetchData(){return _ref.apply(this,arguments);};}();fetchData();}},[fetching,cats,currentPage]);// Подгрузка котиков при скролле\nuseEffect(function(){var scrollHandler=function scrollHandler(e){if(e.target.documentElement.scrollHeight-(e.target.documentElement.scrollTop+window.innerHeight)<100){setFetching(true);}};document.addEventListener('scroll',scrollHandler);return function(){document.removeEventListener('scroll',scrollHandler);};},[setFetching]);useEffect(function(){var catsFavorites=JSON.parse(localStorage.getItem('favorites-cats'));if(catsFavorites){setFavorites(catsFavorites);}},[]);// add like\nvar addToFavorites=function addToFavorites(cats){if(!checked){var newFavoritesList=[].concat(_toConsumableArray(favorites),[cats]);setFavorites(newFavoritesList);saveToLocalStorage(newFavoritesList);setChecked(true);console.log('checked');}else{var _newFavoritesList=favorites.filter(function(el){return el.id!==cats.id;});setFavorites(_newFavoritesList);saveToLocalStorage(_newFavoritesList);setChecked(false);console.log('unchecked');}};var saveToLocalStorage=function saveToLocalStorage(items){localStorage.setItem('favorites-cats',JSON.stringify(items));};return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(Routes,{children:/*#__PURE__*/_jsxs(Route,{path:\"/\",element:/*#__PURE__*/_jsx(Layout,{}),children:[/*#__PURE__*/_jsx(Route,{index:true,element:/*#__PURE__*/_jsx(Homepage,{cats:cats,fetching:fetching,isLoading:isLoading,addToFavorites:addToFavorites,checked:checked})}),/*#__PURE__*/_jsx(Route,{path:\"/favorit-cats\",element:/*#__PURE__*/_jsx(Favoritpage,{addToFavorites:addToFavorites,checked:checked})}),/*#__PURE__*/_jsx(Route,{path:\"*\",element:/*#__PURE__*/_jsx(Notfoundpage,{})})]})})});}export default App;","map":{"version":3,"names":["React","useState","useEffect","Routes","Route","Layout","Homepage","Favoritpage","Notfoundpage","App","cats","setCats","isLoading","setIsLoading","currentPage","setCurrentPage","fetching","setFetching","favorites","setFavorites","checked","setChecked","fetchData","fetch","headers","response","status","json","result","prevState","console","log","scrollHandler","e","target","documentElement","scrollHeight","scrollTop","window","innerHeight","document","addEventListener","removeEventListener","catsFavorites","JSON","parse","localStorage","getItem","addToFavorites","newFavoritesList","saveToLocalStorage","filter","el","id","items","setItem","stringify"],"sources":["/home/user/work2/cats/src/App.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Routes, Route } from 'react-router-dom';\n\nimport Layout from './component/Layout/Layout';\nimport Homepage from './pages/HomePage/Homepage';\nimport Favoritpage from './pages/Favoritpage/Favoritpage';\nimport Notfoundpage from './pages/Notfoundpage/Notfoundpage';\n\nfunction App() {\n  const [cats, setCats] = useState([])\n  const [isLoading, setIsLoading] = useState(true);\n  const [currentPage, setCurrentPage] = useState(1);\n  const [fetching, setFetching] = useState(true);\n  const [favorites, setFavorites] = useState([]);\n  const [checked, setChecked] = useState([false]);\n\n  // Запрос котиков\n  useEffect(() => {\n    if (fetching) {\n      async function fetchData() {\n        try {\n          const response = await fetch(`https://api.thecatapi.com/v1/images/search?limit=20&page=${currentPage}`, {\n            headers: {\n              'Content-Type': 'app;ication/json',\n              'x-api-key': 'e903b6b3-eaca-44ce-829a-f91cff82b3d2',\n            }\n          });\n          if (response.status === 200) {\n            const result = await response.json();\n            setCats([...cats, ...result]);\n            setCurrentPage(prevState => prevState + 1)\n            console.log(result)\n          }\n        }\n        catch (error) {\n          console.log(error)\n        }\n        finally {\n          setIsLoading(false)\n          setFetching(false)\n        }\n      }\n      fetchData()\n    }\n  }, [fetching, cats, currentPage]);\n\n  // Подгрузка котиков при скролле\n  useEffect(() => {\n    const scrollHandler = (e) => {\n      if (e.target.documentElement.scrollHeight - (e.target.documentElement.scrollTop + window.innerHeight) < 100) {\n        setFetching(true);\n      }\n    }\n    document.addEventListener('scroll', scrollHandler)\n    return () => {\n      document.removeEventListener('scroll', scrollHandler)\n    }\n  }, [setFetching]);\n\n  useEffect(() => {\n    const catsFavorites = JSON.parse(\n      localStorage.getItem('favorites-cats')\n    );\n    if (catsFavorites) {\n      setFavorites(catsFavorites);\n    }\n  }, []);\n\n  // add like\n  const addToFavorites = (cats) => {\n    if (!checked) {\n      const newFavoritesList = [...favorites, cats];\n      setFavorites(newFavoritesList);\n      saveToLocalStorage(newFavoritesList);\n      setChecked(true)\n      console.log('checked')\n    } else {\n      const newFavoritesList = favorites.filter(el => el.id !== cats.id);\n      setFavorites(newFavoritesList);\n      saveToLocalStorage(newFavoritesList);\n      setChecked(false)\n      console.log('unchecked')\n    }\n  }\n\n  const saveToLocalStorage = (items) => {\n    localStorage.setItem('favorites-cats', JSON.stringify(items));\n  }\n\n  return (\n    <>\n      <Routes>\n        <Route path=\"/\" element={<Layout />}>\n          <Route index element={<Homepage\n            cats={cats}\n            fetching={fetching}\n            isLoading={isLoading}\n            addToFavorites={addToFavorites}\n            checked={checked}\n          />} />\n          <Route path=\"/favorit-cats\" element={<Favoritpage\n            addToFavorites={addToFavorites}\n            checked={checked}\n          />} />\n          <Route path=\"*\" element={<Notfoundpage />} />\n        </Route>\n      </Routes>\n    </>\n  );\n}\n\nexport default App;"],"mappings":"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"},"metadata":{},"sourceType":"module"}